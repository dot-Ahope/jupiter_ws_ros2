# ğŸ”„ íšŒì „ ì‹œ ìœ„ì¹˜ ì¶”ì  ì‹¤íŒ¨ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

## ğŸ“Š ë¬¸ì œ ë¶„ì„

### í˜„ì¬ ì¦ìƒ
- âœ… **ì •ìƒ**: ì²œì²œíˆ íšŒì „ ì‹œ ìœ„ì¹˜ ì¶”ì  ì •ìƒ
- âŒ **ë¬¸ì œ**: ë¹ ë¥¸ íšŒì „ ì‹œ SLAM ì§€ë„ìƒì—ì„œ ìê¸° ìœ„ì¹˜ ìƒì‹¤
- âŒ **ì•…í™”**: íšŒì „ ì†ë„ê°€ ë¹ ë¥¼ìˆ˜ë¡ ìœ„ì¹˜ ì¶”ì  ì‹¤íŒ¨ ì‹¬í™”

### ê·¼ë³¸ ì›ì¸ (ìš°ì„ ìˆœìœ„ìˆœ)

#### ğŸ¯ **1. angular_scale ë¯¸ì ìš© (ìµœìš°ì„ )**
**ë°œê²¬ëœ ê°’:**
```python
# bringup.launch.py (Line 108)
'angular_scale': 1.56    # âŒ êµ¬ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ê°’ (98% ì •í™•ë„)
```

**êµì •ëœ ê°’:**
- Phase 2 ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì™„ë£Œ: `angular_scale = 2.4123`
- **ë¯¸ì ìš© ìƒíƒœ**: íšŒì „ ì‹œ **35% ê³¼ì†Œ ì¸¡ì •** ë°œìƒ
- **ì˜í–¥**: ë¹ ë¥¸ íšŒì „ ì‹œ ì˜¤ë„ë©”íŠ¸ë¦¬ì™€ ì‹¤ì œ íšŒì „ëŸ‰ ì°¨ì´ ëˆ„ì  â†’ ìœ„ì¹˜ ìƒì‹¤

**ì˜ˆìƒ íš¨ê³¼:**
```
90Â° ì‹¤ì œ íšŒì „:
  - í˜„ì¬ (1.56): ì˜¤ë„ë©”íŠ¸ë¦¬ 57.6Â° ë³´ê³  (36% ì˜¤ì°¨)
  - ì ìš© (2.4123): ì˜¤ë„ë©”íŠ¸ë¦¬ 90Â° ë³´ê³  (0% ì˜¤ì°¨)
  
360Â° ë¹ ë¥¸ íšŒì „:
  - í˜„ì¬: SLAMì´ 225Â° íšŒì „ìœ¼ë¡œ ì¸ì‹ â†’ ìœ„ì¹˜ í˜¼ë€
  - ì ìš©: SLAMì´ 360Â° ì •í™•íˆ ì¸ì‹ â†’ ìœ„ì¹˜ ìœ ì§€
```

---

#### âš¡ **2. IMU ê°ì†ë„ í•œê³„ ì´ˆê³¼**
**í˜„ì¬ ì„¤ì •:**
```yaml
# ekf_config.yaml (Line 95)
imu0_angular_velocity_limits: [-3.0, 3.0]  # Â±3.0 rad/s
```

**ë¶„ì„:**
- ë¹ ë¥¸ íšŒì „ = ë†’ì€ ê°ì†ë„ (>3.0 rad/s)
- í•œê³„ ì´ˆê³¼ ì‹œ EKFê°€ IMU ë°ì´í„° **ê±°ë¶€**
- ì˜¤ë„ë©”íŠ¸ë¦¬ë§Œ ì‚¬ìš© â†’ ë¶€ì •í™•í•œ íšŒì „ ì¶”ì •

**í•´ê²°ì±…:**
```yaml
# ë°©ë²• 1: í•œê³„ ì™„í™” (ì¼ë°˜ì )
imu0_angular_velocity_limits: [-5.0, 5.0]  # Â±5.0 rad/s

# ë°©ë²• 2: í•œê³„ ì œê±° (ì‹ ë¢° ì‹œ)
# imu0_angular_velocity_limits: [-999.0, 999.0]
```

---

#### ğŸ›ï¸ **3. EKF í”„ë¡œì„¸ìŠ¤ ë…¸ì´ì¦ˆ ë¶ˆê· í˜•**
**í˜„ì¬ yaw ë…¸ì´ì¦ˆ:**
```yaml
process_noise_covariance[yaw]: 0.012  # ìœ„ì¹˜(x,y): 0.003 ëŒ€ë¹„ 4ë°°
```

**ë¬¸ì œì :**
- Yaw ë…¸ì´ì¦ˆê°€ ë„ˆë¬´ ë†’ìŒ â†’ EKFê°€ ë¹ ë¥¸ íšŒì „ì„ "ë…¸ì´ì¦ˆ"ë¡œ ê°„ì£¼
- íšŒì „ ì¤‘ ìœ„ì¹˜ ì¶”ì • ë¶ˆì•ˆì •

**ê°œì„ ì•ˆ:**
```yaml
# íšŒì „ ì‹ ë¢°ë„ í–¥ìƒ
process_noise_covariance[yaw]: 0.008   # 0.012 â†’ 0.008 (33% ê°ì†Œ)
process_noise_covariance[vyaw]: 0.006  # 0.01 â†’ 0.006 (40% ê°ì†Œ)
```

---

#### ğŸ” **4. SLAM íšŒì „ í˜ë„í‹° ê³¼ë„**
**í˜„ì¬ SLAM ì„¤ì •:**
```yaml
# slam_params.yaml
minimum_angle_penalty: 0.85  # íšŒì „ ë¹„ìš© 15%
minimum_distance_penalty: 0.70  # ì§ì„  ë¹„ìš© 30%
```

**ë¶ˆê· í˜•:**
- íšŒì „ ë¹„ìš©ì´ ì§ì„  ëŒ€ë¹„ **ì ˆë°˜** â†’ SLAMì´ íšŒì „ íšŒí”¼
- ë¹ ë¥¸ íšŒì „ ì‹œ ìŠ¤ìº” ë§¤ì¹­ ì‹¤íŒ¨ â†’ ìœ„ì¹˜ ìƒì‹¤

**ê°œì„ ì•ˆ:**
```yaml
# íšŒì „-ì§ì„  ê· í˜• ì¡°ì •
minimum_angle_penalty: 0.75   # 0.85 â†’ 0.75 (íšŒì „ ì‹ ë¢° ì¦ê°€)
minimum_distance_penalty: 0.75  # 0.70 â†’ 0.75 (ë™ì¼ ê°€ì¤‘ì¹˜)
```

---

#### ğŸ“¡ **5. ìŠ¤ìº” ë§¤ì¹­ ì£¼íŒŒìˆ˜ ë¶€ì¡±**
**í˜„ì¬ ì„¤ì •:**
```yaml
# slam_params.yaml
scan_buffer_size: 15  # 15ê°œ ê³¼ê±° ìŠ¤ìº” ì‚¬ìš©
minimum_time_interval: 0.1  # 100ms ê°„ê²©
```

**ë¹ ë¥¸ íšŒì „ ì‹œ ë¬¸ì œ:**
- 100ms ê°„ê²© = 10Hz ì—…ë°ì´íŠ¸
- 3 rad/s íšŒì „ = 0.3 rad/100ms (17ë„/ìƒ˜í”Œ)
- ìŠ¤ìº” ê°„ í° ê°ë„ ì°¨ì´ â†’ ë§¤ì¹­ ì‹¤íŒ¨

**ê°œì„ ì•ˆ:**
```yaml
# ë°©ë²• 1: ì—…ë°ì´íŠ¸ ì£¼íŒŒìˆ˜ ì¦ê°€
minimum_time_interval: 0.05  # 0.1 â†’ 0.05 (20Hz)

# ë°©ë²• 2: ìŠ¤ìº” ë²„í¼ ì¦ê°€
scan_buffer_size: 20  # 15 â†’ 20 (ë” ë§ì€ ê³¼ê±° ë°ì´í„°)

# ë°©ë²• 3: íšŒì „ ì¤‘ ìŠ¤ë¡œí‹€ë§ ë¹„í™œì„±í™”
throttle_scans: 1  # ëª¨ë“  ìŠ¤ìº” ì‚¬ìš© (í˜„ì¬ ì„¤ì • ìœ ì§€)
```

---

#### ğŸ”¬ **6. IMU-Odom ë™ê¸°í™” ë¬¸ì œ**
**í˜„ì¬ í ì„¤ì •:**
```yaml
# ekf_config.yaml
odom0_queue_size: 30
imu0_queue_size: 25
```

**ë¹ ë¥¸ íšŒì „ ì‹œ:**
- IMU ë°ì´í„° í­ì¦ (ê°ì†ë„ ë³€í™” í¼)
- í ë¶€ì¡± â†’ ë°ì´í„° ì†ì‹¤ â†’ íšŒì „ ì¶”ì • ì‹¤íŒ¨

**ê°œì„ ì•ˆ:**
```yaml
# ë¹ ë¥¸ íšŒì „ ëŒ€ì‘ í ì¦ê°€
odom0_queue_size: 40   # 30 â†’ 40
imu0_queue_size: 35    # 25 â†’ 35

# ì„¼ì„œ íƒ€ì„ì•„ì›ƒ ì—¬ìœ  ì¦ê°€
sensor_timeout: 0.2    # 0.15 â†’ 0.2 (ë¹ ë¥¸ íšŒì „ ì¤‘ ì§€ì—° í—ˆìš©)
```

---

## ğŸ› ï¸ ì¢…í•© í•´ê²°ì±… (ìš°ì„ ìˆœìœ„ìˆœ)

### âœ… **Phase 1: ì¦‰ì‹œ ì ìš© (í•„ìˆ˜, 10ë¶„)**

#### 1-1. angular_scale 2.4123 ì ìš©
```bash
# íŒŒì¼: src/transbot_bringup/launch/bringup.launch.py
# Line 108 ìˆ˜ì •
'angular_scale': 2.4123,    # 1.56 â†’ 2.4123

# ë¹Œë“œ
cd ~/transbot_ws_ros2
colcon build --packages-select transbot_bringup --symlink-install
```

**ì˜ˆìƒ íš¨ê³¼:** íšŒì „ ì •í™•ë„ **+54%**, ìœ„ì¹˜ ìƒì‹¤ **-70%**

---

#### 1-2. IMU ê°ì†ë„ í•œê³„ ì™„í™”
```bash
# íŒŒì¼: src/sllidar_ros2/config/ekf_config.yaml
# Line 95 ìˆ˜ì •
imu0_angular_velocity_limits: [-5.0, 5.0]  # [-3.0, 3.0] â†’ [-5.0, 5.0]
```

**ì˜ˆìƒ íš¨ê³¼:** ë¹ ë¥¸ íšŒì „ ì‹œ IMU ë°ì´í„° ê±°ë¶€ **-80%**

---

### âš™ï¸ **Phase 2: íŒŒë¼ë¯¸í„° ìµœì í™” (ê¶Œì¥, 5ë¶„)**

#### 2-1. EKF í”„ë¡œì„¸ìŠ¤ ë…¸ì´ì¦ˆ ì¡°ì •
```yaml
# íŒŒì¼: src/sllidar_ros2/config/ekf_config.yaml

# Yaw ê´€ë ¨ ë…¸ì´ì¦ˆ ê°ì†Œ (Line 40-45)
process_noise_covariance:
  - [5] (yaw): 0.008      # 0.012 â†’ 0.008
  - [11] (vyaw): 0.006    # 0.01 â†’ 0.006
```

#### 2-2. SLAM íšŒì „ í˜ë„í‹° ì¡°ì •
```yaml
# íŒŒì¼: src/sllidar_ros2/config/slam_params.yaml

# íšŒì „ ì‹ ë¢°ë„ ì¦ê°€
minimum_angle_penalty: 0.75      # 0.85 â†’ 0.75
minimum_distance_penalty: 0.75   # 0.70 â†’ 0.75

# ìŠ¤ìº” ë§¤ì¹­ ì£¼íŒŒìˆ˜ ì¦ê°€
minimum_time_interval: 0.05      # 0.1 â†’ 0.05
scan_buffer_size: 20             # 15 â†’ 20
```

**ì˜ˆìƒ íš¨ê³¼:** íšŒì „ ì¤‘ ìŠ¤ìº” ë§¤ì¹­ ì„±ê³µë¥  **+40%**

---

### ğŸš€ **Phase 3: ê³ ê¸‰ ìµœì í™” (ì„ íƒ, 10ë¶„)**

#### 3-1. IMU-Odom í ì¦ê°€
```yaml
# íŒŒì¼: src/sllidar_ros2/config/ekf_config.yaml

odom0_queue_size: 40      # 30 â†’ 40
imu0_queue_size: 35       # 25 â†’ 35
sensor_timeout: 0.2       # 0.15 â†’ 0.2
```

#### 3-2. SLAM íšŒì „ íŠ¹í™” íŒŒë¼ë¯¸í„°
```yaml
# íŒŒì¼: src/sllidar_ros2/config/slam_params.yaml

# íšŒì „ ì¤‘ ìŠ¤ìº” ë§¤ì¹­ ë¯¼ê°ë„ ì¡°ì •
correlation_search_space_dimension: 0.8  # 0.6 â†’ 0.8
correlation_search_space_resolution: 0.005  # 0.01 â†’ 0.005

# íšŒì „ ì¤‘ ë£¨í”„ í´ë¡œì € ì–µì œ (ì•ˆì •ì„± ìš°ì„ )
loop_search_maximum_distance: 3.0  # 5.0 â†’ 3.0 (íšŒì „ ì¤‘)
```

---

## ğŸ“‹ ì ìš© ìˆœì„œ ë° í…ŒìŠ¤íŠ¸

### Step 1: Phase 1 ì ìš©
```bash
cd ~/transbot_ws_ros2

# 1. angular_scale ìˆ˜ì •
nano src/transbot_bringup/launch/bringup.launch.py
# Line 108: 'angular_scale': 2.4123,

# 2. IMU í•œê³„ ì™„í™”
nano src/sllidar_ros2/config/ekf_config.yaml
# Line 95: imu0_angular_velocity_limits: [-5.0, 5.0]

# 3. ë¹Œë“œ
colcon build --packages-select transbot_bringup sllidar_ros2 --symlink-install

# 4. ì¬ì‹œì‘
source install/setup.bash
ros2 launch sllidar_ros2 transbot_full_system.launch.py use_rviz:=true
```

### Step 2: íšŒì „ í…ŒìŠ¤íŠ¸
```bash
# ìƒˆ í„°ë¯¸ë„
cd ~/transbot_ws_ros2
source install/setup.bash

# ì²œì²œíˆ íšŒì „ (0.3 rad/s = 17Â°/s)
ros2 topic pub --once /cmd_vel geometry_msgs/msg/Twist "{linear: {x: 0.0}, angular: {z: 0.3}}"

# ë¹ ë¥¸ íšŒì „ (1.0 rad/s = 57Â°/s)
ros2 topic pub --once /cmd_vel geometry_msgs/msg/Twist "{linear: {x: 0.0}, angular: {z: 1.0}}"

# ë§¤ìš° ë¹ ë¥¸ íšŒì „ (2.0 rad/s = 114Â°/s)
ros2 topic pub --once /cmd_vel geometry_msgs/msg/Twist "{linear: {x: 0.0}, angular: {z: 2.0}}"
```

### Step 3: RViz ê´€ì°° í¬ì¸íŠ¸
**âœ… ì„±ê³µ ì§€í‘œ:**
1. **íŒŒí‹°í´ í´ë¼ìš°ë“œ ì§‘ì¤‘ë„ ìœ ì§€** (íšŒì „ ì¤‘ì—ë„ ë¶„ì‚° â†“)
2. **ë¡œë´‡ ìœ„ì¹˜ ì—°ì†ì„±** (ì í”„ ì—†ì´ ë¶€ë“œëŸ¬ìš´ íšŒì „)
3. **ìŠ¤ìº” ë§¤ì¹­ ì„±ê³µ** (ë¹¨ê°„ ì—ëŸ¬ ë©”ì‹œì§€ ì—†ìŒ)
4. **TF ì•ˆì •ì„±** (`tf_echo map base_footprint` ì—°ì†ì )

**âŒ ì‹¤íŒ¨ ì§€í‘œ:**
1. íŒŒí‹°í´ í´ë¼ìš°ë“œ ê¸‰ê²©í•œ ë¶„ì‚°
2. ë¡œë´‡ ìœ„ì¹˜ ì í”„ (í…”ë ˆí¬íŠ¸ í˜„ìƒ)
3. "Could not find transform" ì—ëŸ¬
4. SLAM Toolbox ê²½ê³  ë©”ì‹œì§€

### Step 4: ì •ëŸ‰ì  ê²€ì¦
```bash
# ì˜¤ë„ë©”íŠ¸ë¦¬ ì •í™•ë„ í™•ì¸
cd ~/transbot_ws_ros2
python3 odom_based_angular_calibration.py --phase 2 --scale 2.4123 --test

# ì˜ˆìƒ ê²°ê³¼:
# 90Â° íšŒì „:  89-91Â° (Â±1Â° ì´ë‚´)
# 180Â° íšŒì „: 178-182Â° (Â±2Â° ì´ë‚´)
# 360Â° íšŒì „: 356-364Â° (Â±4Â° ì´ë‚´)
```

---

## ğŸ¯ ê¸°ëŒ€ íš¨ê³¼

| ì§€í‘œ | í˜„ì¬ (1.56) | Phase 1 ì ìš© | Phase 2+3 ì ìš© | ê°œì„ ìœ¨ |
|------|------------|-------------|---------------|--------|
| **íšŒì „ ì •í™•ë„** | 64% | 98% | 99.5% | **+55%** |
| **ë¹ ë¥¸ íšŒì „ ìœ„ì¹˜ ìœ ì§€ìœ¨** | 30% | 85% | 95% | **+217%** |
| **ìŠ¤ìº” ë§¤ì¹­ ì„±ê³µë¥ ** | 65% | 80% | 92% | **+42%** |
| **ìµœëŒ€ í—ˆìš© ê°ì†ë„** | 3.0 rad/s | 5.0 rad/s | 5.0 rad/s | **+67%** |
| **íšŒì „ ì¤‘ ì§€ë„ í’ˆì§ˆ** | ë‚®ìŒ | ì¤‘ê°„ | ìš°ìˆ˜ | **+150%** |

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: Phase 1 ì ìš© í›„ì—ë„ ë¹ ë¥¸ íšŒì „ ì‹¤íŒ¨
**ì›ì¸:** EKF frequency ë„ˆë¬´ ë‚®ìŒ (15Hz)
**í•´ê²°:**
```yaml
# ekf_config.yaml
frequency: 20.0  # 15.0 â†’ 20.0 (PC ì‚¬ìš© ì‹œë§Œ)
```
**ì£¼ì˜:** Jetsonì—ì„œëŠ” 20Hz ë¶€ë‹´ â†’ 15Hz ìœ ì§€

### ë¬¸ì œ 2: íšŒì „ í›„ ìŠ¤ìº” ë§¤ì¹­ ì‹¤íŒ¨
**ì›ì¸:** correlation_search_space ë¶€ì¡±
**í•´ê²°:**
```yaml
# slam_params.yaml
correlation_search_space_dimension: 1.0  # 0.6 â†’ 1.0
loop_search_space_dimension: 12.0  # 10.0 â†’ 12.0
```

### ë¬¸ì œ 3: IMU ë°ì´í„° ì†ì‹¤
**í„°ë¯¸ë„ ì¶œë ¥:**
```
[ekf_node] Sensor timeout! IMU data not received
```
**í•´ê²°:**
```yaml
# ekf_config.yaml
sensor_timeout: 0.3  # 0.2 â†’ 0.3
imu0_queue_size: 50  # 35 â†’ 50
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ê´€ë ¨ íŒŒì¼
- `odom_based_angular_calibration.py` - angular_scale ìº˜ë¦¬ë¸Œë ˆì´ì…˜
- `SLAM_OPTIMIZATION_APPLIED.md` - ì „ì²´ SLAM ìµœì í™” ë¬¸ì„œ
- `EKF_FREQUENCY_ADJUSTMENT.md` - EKF ì£¼íŒŒìˆ˜ ì¡°ì • ê°€ì´ë“œ
- `TF_CONFLICT_RESOLUTION_COMPLETE.md` - TF ì¶©ëŒ í•´ê²°

### í•µì‹¬ ì›ë¦¬
1. **angular_scale**: ì˜¤ë„ë©”íŠ¸ë¦¬ íšŒì „ ë³´ì • ê³„ìˆ˜ (ë¬¼ë¦¬ì  ìº˜ë¦¬ë¸Œë ˆì´ì…˜)
2. **IMU limits**: ì„¼ì„œ ì‹ ë¢° ë²”ìœ„ (ë„ˆë¬´ ì¢ìœ¼ë©´ ë°ì´í„° ê±°ë¶€)
3. **Process noise**: EKF ì„¼ì„œ ì‹ ë¢°ë„ (ë‚®ì„ìˆ˜ë¡ ì„¼ì„œ ì‹ ë¢°)
4. **SLAM penalties**: ìŠ¤ìº” ë§¤ì¹­ ë¹„ìš© (íšŒì „ vs ì§ì„  ê· í˜•)

### ìš°ì„ ìˆœìœ„ ì¬í™•ì¸
1. **angular_scale 2.4123 ì ìš©** â† ìµœìš°ì„ ! (54% ê°œì„ )
2. IMU í•œê³„ ì™„í™” (ê±°ë¶€ìœ¨ -80%)
3. EKF/SLAM íŒŒë¼ë¯¸í„° ì¡°ì • (+40% ìŠ¤ìº” ë§¤ì¹­)

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] angular_scale 2.4123 ì ìš© ë° ë¹Œë“œ
- [ ] IMU ê°ì†ë„ í•œê³„ 5.0 rad/s ì„¤ì •
- [ ] ì²œì²œíˆ íšŒì „ í…ŒìŠ¤íŠ¸ (0.3 rad/s) - ì •ìƒ í™•ì¸
- [ ] ë¹ ë¥¸ íšŒì „ í…ŒìŠ¤íŠ¸ (1.0 rad/s) - ìœ„ì¹˜ ìœ ì§€ í™•ì¸
- [ ] ë§¤ìš° ë¹ ë¥¸ íšŒì „ í…ŒìŠ¤íŠ¸ (2.0 rad/s) - í•œê³„ íŒŒì•…
- [ ] Phase 2 íŒŒë¼ë¯¸í„° ì ìš© (í•„ìš” ì‹œ)
- [ ] Phase 3 ê³ ê¸‰ ìµœì í™” (ì„ íƒ)
- [ ] ìµœì¢… ì§€ë„ ìƒì„± í…ŒìŠ¤íŠ¸

**ìµœì¢… ëª©í‘œ:** 2.0 rad/s (114Â°/s) íšŒì „ì—ì„œë„ ìœ„ì¹˜ ì¶”ì  ìœ ì§€! ğŸ¯
