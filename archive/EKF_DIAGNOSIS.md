# EKF ë¬¸ì œ ì§„ë‹¨ ë° í•´ê²° ë°©ì•ˆ

## ğŸ“Š **í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„**

### **ê´€ì°°ëœ í˜„ìƒ:**
```
IMU ê¸°ì¤€ ë°˜ì‹œê³„: EKF 96.08Â° (ì •ìƒ)
IMU ê¸°ì¤€ ì‹œê³„:   EKF  4.04Â° (24ë°° ì°¨ì´!)
â†’ ê°™ì€ ë¬¼ë¦¬ì  íšŒì „(90Â°)ì¸ë° EKF ê²°ê³¼ê°€ ì™„ì „íˆ ë‹¤ë¦„
```

---

## ğŸ” **ì›ì¸ 1: Rejection Threshold ë¬¸ì œ**

### **í˜„ì¬ ì„¤ì •:**
```yaml
odom0_twist_rejection_threshold: 3.0
imu0_twist_rejection_threshold: 5.0
```

### **ì‹¤ì œ ì„¼ì„œ ì°¨ì´:**
```
IMU ê¸°ì¤€ íšŒì „:
  IMU ì ë¶„: 86-88Â° (ì •í™•)
  Odom ì¸¡ì •: 68-73Â° (ë¶€ì¡±)
  ì°¨ì´: 15-20Â° 

â†’ ì°¨ì´ê°€ rejection threshold ë²”ìœ„ì— ê·¼ì ‘
â†’ EKFê°€ ì„¼ì„œë¥¼ ê±°ë¶€í•˜ê±°ë‚˜ ê°€ì¤‘ì¹˜ë¥¼ ê·¹ë‹¨ì ìœ¼ë¡œ ì¡°ì •
```

### **ë¬¸ì œ:**
- **Thresholdê°€ ë„ˆë¬´ ë‚®ìŒ**: ì„¼ì„œ ê°„ ì°¨ì´ê°€ ì •ìƒì´ì§€ë§Œ ê±°ë¶€ë¨
- **Mahalanobis distance ê³„ì‚°**: ë‹¨ìˆœ ì°¨ì´ê°€ ì•„ë‹Œ ê³µë¶„ì‚° ê³ ë ¤
- ì„¼ì„œ ì°¨ì´ 15Â°ê°€ threshold 3-5ë¥¼ ì´ˆê³¼í•  ìˆ˜ ìˆìŒ

### **í•´ê²°ì±…:**
```yaml
# Rejection threshold ëŒ€í­ ì¦ê°€
odom0_twist_rejection_threshold: 10.0  # 3.0 â†’ 10.0
imu0_twist_rejection_threshold: 15.0   # 5.0 â†’ 15.0
```

---

## ğŸ” **ì›ì¸ 2: ì´ˆê¸° ê³µë¶„ì‚° ë¬¸ì œ**

### **í˜„ì¬ ì„¤ì •:**
```yaml
initial_estimate_covariance:
  yaw (index 5): 1000.0  # ë§¤ìš° í° ë¶ˆí™•ì‹¤ì„±
  yaw_vel (index 11): 0.2  # ì‘ì€ ë¶ˆí™•ì‹¤ì„±
```

### **ë¬¸ì œ:**
- **yaw ë¶ˆí™•ì‹¤ì„±ì´ ë„ˆë¬´ í¼**: 1000.0
- ì²« íšŒì „ ì‹œ EKFê°€ ì„¼ì„œë¥¼ ì‹ ë¢°í•˜ì§€ ì•ŠìŒ
- ë°©í–¥ì— ë”°ë¼ ì´ˆê¸° ìˆ˜ë ´ì´ ë‹¤ë¦„

### **í•´ê²°ì±…:**
```yaml
# yaw ì´ˆê¸° ë¶ˆí™•ì‹¤ì„± ê°ì†Œ
initial_estimate_covariance:
  yaw (index 5): 10.0  # 1000.0 â†’ 10.0 (ì ë‹¹í•œ ë¶ˆí™•ì‹¤ì„±)
  yaw_vel (index 11): 0.5  # 0.2 â†’ 0.5 (ì•½ê°„ ì¦ê°€)
```

---

## ğŸ” **ì›ì¸ 3: Process Noise ë¶ˆê· í˜•**

### **í˜„ì¬ ì„¤ì •:**
```yaml
process_noise_covariance:
  yaw (index 5): 0.015
  yaw_vel (index 11): 0.005  # IMU ì‹ ë¢°ë„ ë†’ìŒ
```

### **ë¬¸ì œ:**
- **yaw_vel ë…¸ì´ì¦ˆê°€ ë„ˆë¬´ ì‘ìŒ**: EKFê°€ IMUë¥¼ ë„ˆë¬´ ì‹ ë¢°
- IMUì™€ Odom ì°¨ì´ ë°œìƒ ì‹œ Odomì„ ê³¼ë„í•˜ê²Œ ë¬´ì‹œ
- ê²°ê³¼ì ìœ¼ë¡œ EKFê°€ í•œìª½ì— í¸í–¥

### **í•´ê²°ì±…:**
```yaml
# Process noise ê· í˜• ì¡°ì •
process_noise_covariance:
  yaw (index 5): 0.03  # 0.015 â†’ 0.03 (ì¦ê°€)
  yaw_vel (index 11): 0.01  # 0.005 â†’ 0.01 (ì¦ê°€)
```

---

## ğŸ” **ì›ì¸ 4: Differential/Relative ì„¤ì • ë¹„ëŒ€ì¹­**

### **í˜„ì¬ ì„¤ì •:**
```yaml
odom0_differential: true   # ë³€í™”ëŸ‰ ì‚¬ìš©
odom0_relative: false      # ì ˆëŒ€ ì¸¡ì •

imu0_differential: true    # ë³€í™”ëŸ‰ ì‚¬ìš©
imu0_relative: true        # ìƒëŒ€ ì¸¡ì •
```

### **ë¬¸ì œ:**
- **Odom: ì ˆëŒ€ ì¸¡ì •, IMU: ìƒëŒ€ ì¸¡ì •**
- ê¸°ì¤€ì ì´ ë‹¤ë¦„
- ë°©í–¥ ì „í™˜ ì‹œ ëˆ„ì  ì˜¤ì°¨ê°€ ë¹„ëŒ€ì¹­ì ìœ¼ë¡œ ì‘ìš©

### **í•´ê²°ì±…:**
```yaml
# ë‘˜ ë‹¤ differential + relativeë¡œ í†µì¼
odom0_differential: true
odom0_relative: true  # false â†’ true

imu0_differential: true
imu0_relative: true
```

---

## ğŸ“‹ **ì¢…í•© ìˆ˜ì • ê³„íš**

### **ìš°ì„ ìˆœìœ„ 1: Rejection Threshold (ì¦‰ì‹œ íš¨ê³¼)**
```yaml
odom0_twist_rejection_threshold: 10.0
imu0_twist_rejection_threshold: 15.0
```

### **ìš°ì„ ìˆœìœ„ 2: ì´ˆê¸° ê³µë¶„ì‚° (ìˆ˜ë ´ ì•ˆì •ì„±)**
```yaml
initial_estimate_covariance:
  yaw: 10.0  # 1000.0 â†’ 10.0
  yaw_vel: 0.5  # 0.2 â†’ 0.5
```

### **ìš°ì„ ìˆœìœ„ 3: Process Noise (ì„¼ì„œ ê· í˜•)**
```yaml
process_noise_covariance:
  yaw: 0.03  # 0.015 â†’ 0.03
  yaw_vel: 0.01  # 0.005 â†’ 0.01
```

### **ìš°ì„ ìˆœìœ„ 4: Relative ì„¤ì • (ì¼ê´€ì„±)**
```yaml
odom0_relative: true  # false â†’ true
```

---

## ğŸ¯ **ì˜ˆìƒ íš¨ê³¼**

### **ìˆ˜ì • ì „:**
```
IMU ê¸°ì¤€ ë°˜ì‹œê³„: EKF 96.08Â°
IMU ê¸°ì¤€ ì‹œê³„:   EKF  4.04Â°
ì°¨ì´: 92.04Â° âŒ
```

### **ìˆ˜ì • í›„ ì˜ˆìƒ:**
```
IMU ê¸°ì¤€ ë°˜ì‹œê³„: EKF ~85-90Â°
IMU ê¸°ì¤€ ì‹œê³„:   EKF ~85-90Â°
ì°¨ì´: <10Â° âœ…
```

### **ê·¼ê±°:**
1. **Rejection threshold ì¦ê°€** â†’ ì„¼ì„œ ë°ì´í„° ë” ìˆ˜ìš©
2. **ì´ˆê¸° ê³µë¶„ì‚° ê°ì†Œ** â†’ ë¹ ë¥¸ ìˆ˜ë ´
3. **Process noise ì¦ê°€** â†’ ì„¼ì„œ ê· í˜•
4. **Relative í†µì¼** â†’ ë°©í–¥ ì¼ê´€ì„±

---

## âš ï¸ **ì£¼ì˜ì‚¬í•­**

### **Trade-off:**
- Rejection threshold â†‘ â†’ ì´ìƒì¹˜ ìˆ˜ìš© ìœ„í—˜ â†‘
- Process noise â†‘ â†’ í•„í„° ë°˜ì‘ì„± â†“
- ì´ˆê¸° ê³µë¶„ì‚° â†“ â†’ ì˜ëª»ëœ ì´ˆê¸°ê°’ì— ì·¨ì•½

### **ê²€ì¦ ë°©ë²•:**
1. ìˆ˜ì • í›„ `ekf_comparison_test.py` ì¬ì‹¤í–‰
2. EKF ì¼ê´€ì„± í™•ì¸ (ì°¨ì´ < 10Â°)
3. ì‹¤ì œ ë¡œë´‡ ë™ì‘ í…ŒìŠ¤íŠ¸
