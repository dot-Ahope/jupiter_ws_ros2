# ğŸ” ì˜¤ë„ë©”íŠ¸ë¦¬ í† í”½ ë°ì´í„° íë¦„ ë¶„ì„

## ğŸ“Š í† í”½ ëª©ë¡ ë° ë°œí–‰ ì£¼íŒŒìˆ˜

| í† í”½ | ë©”ì‹œì§€ íƒ€ì… | ë°œí–‰ ì£¼íŒŒìˆ˜ | ë°œí–‰ì | êµ¬ë…ì |
|------|------------|------------|--------|--------|
| `/cmd_vel` | `geometry_msgs/msg/Twist` | N/A (ëª…ë ¹) | ì—†ìŒ | `transbot_driver` |
| `/transbot/get_vel` | `geometry_msgs/msg/Twist` | **~50 Hz** | `transbot_driver` | `base_node` |
| `/odom_raw` | `nav_msgs/msg/Odometry` | **~50 Hz** | `base_node` | `ekf_filter_node` |
| `/odometry/filtered` | `nav_msgs/msg/Odometry` | **~49 Hz** | `ekf_filter_node` | ì—†ìŒ (ì‹œìŠ¤í…œìš©) |
| `/odom` | `nav_msgs/msg/Odometry` | N/A | **ì—†ìŒ** âŒ | `rviz2` |
| `/transbot/imu` | `sensor_msgs/msg/Imu` | ~100 Hz | `transbot_driver` | `apply_calib` |
| `/imu/data_calibrated` | `sensor_msgs/msg/Imu` | **~98 Hz** | `apply_calib` | `ekf_filter_node` |

---

## ğŸ”„ ë°ì´í„° íë¦„ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ì˜¤ë„ë©”íŠ¸ë¦¬ ë°ì´í„° íë¦„                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£  í•˜ë“œì›¨ì–´ ê³„ì¸µ
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ì—”ì½”ë” (I2C)â”‚         â”‚ MPU6050(I2C)â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚                       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
2ï¸âƒ£  ë“œë¼ì´ë²„ ê³„ì¸µ
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  transbot_driver   â”‚
          â”‚  (í•˜ë“œì›¨ì–´ ì¸í„°í˜ì´ìŠ¤)â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                 â”‚        â”‚
        /transbot/get_vel â”‚ /transbot/imu
        (Twist, 50Hz)     â”‚ (Imu, 100Hz)
                 â”‚        â”‚
                 â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â–¼                      â–¼
3ï¸âƒ£  ì²˜ë¦¬ ê³„ì¸µ
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   base_node      â”‚    â”‚   apply_calib    â”‚
    â”‚ (ì˜¤ë„ë©”íŠ¸ë¦¬ ê³„ì‚°)  â”‚    â”‚   (IMU ë³´ì •)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                       â”‚
      /odom_raw                /imu/data_calibrated
    (Odometry, 50Hz)           (Imu, 98Hz)
             â”‚                       â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
4ï¸âƒ£  ìœµí•© ê³„ì¸µ
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  ekf_filter_node   â”‚
            â”‚  (ì„¼ì„œ ìœµí•©)         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
              /odometry/filtered
            (Odometry, 49Hz)
                       â”‚
                       â–¼
5ï¸âƒ£  ì‘ìš© ê³„ì¸µ
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   slam_toolbox     â”‚
            â”‚   nav2_stack       â”‚
            â”‚   (ì‚¬ìš© ì•ˆ í•¨ âŒ)    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ ë¬¸ì œ: /odometry/filteredë¥¼ ì‚¬ìš©í•˜ëŠ” ë…¸ë“œê°€ ì—†ìŒ!
```

---

## ğŸ¯ ë…¸ë“œë³„ ìƒì„¸ ë¶„ì„

### 1ï¸âƒ£ **transbot_driver** (í•˜ë“œì›¨ì–´ ë“œë¼ì´ë²„)

**ì—­í• **: í•˜ë“œì›¨ì–´ì™€ ROS2 ê°„ ì¸í„°í˜ì´ìŠ¤

**êµ¬ë… (Subscribers)**:
- `/cmd_vel` (geometry_msgs/msg/Twist)
  - ë¡œë´‡ ì œì–´ ëª…ë ¹ ìˆ˜ì‹ 
  - ëª¨í„° ì†ë„ ì œì–´

**ë°œí–‰ (Publishers)**:
- `/transbot/get_vel` (geometry_msgs/msg/Twist) - **50 Hz** â­
  - ì—”ì½”ë”ì—ì„œ ì¸¡ì •í•œ ì‹¤ì œ ì†ë„
  - Linear: v_x, v_y (m/s)
  - Angular: Ï‰_z (rad/s)
  - **ì½”ë“œ**: `transbot_driver.py:132` - `self.create_timer(0.02, self.publish_velocity)`
  
- `/transbot/imu` (sensor_msgs/msg/Imu) - **100 Hz**
  - MPU6050 ì›ì‹œ ë°ì´í„°
  - ìì´ë¡œ ë°”ì´ì–´ìŠ¤ í¬í•¨
  - ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„

**ë°ì´í„° ì†ŒìŠ¤**:
```python
# Transbot_Lib.Get_Encoder_Velocity()
# I2C í†µì‹ ìœ¼ë¡œ ì—”ì½”ë” í„ìŠ¤ ì½ê¸°
# ë°˜í™˜: (ì™¼ìª½ ì†ë„, ì˜¤ë¥¸ìª½ ì†ë„) mm/s
```

---

### 2ï¸âƒ£ **base_node** (ì˜¤ë„ë©”íŠ¸ë¦¬ ê³„ì‚°)

**ì—­í• **: íœ  ì†ë„ë¥¼ ì ë¶„í•˜ì—¬ ì˜¤ë„ë©”íŠ¸ë¦¬ ìƒì„±

**êµ¬ë… (Subscribers)**:
- `/transbot/get_vel` (geometry_msgs/msg/Twist) - **50 Hz**
  - ì—”ì½”ë” ì†ë„ ë°ì´í„° ìˆ˜ì‹ 

**ë°œí–‰ (Publishers)**:
- `/odom_raw` (nav_msgs/msg/Odometry) - **50 Hz** â­
  - ìœ„ì¹˜: (x, y, yaw)
  - ì†ë„: (v_x, v_y, Ï‰_z)
  - ê³µë¶„ì‚°: ìœ„ì¹˜ ë° ì†ë„ ë¶ˆí™•ì‹¤ì„±
  
- `/tf` (odom â†’ base_footprint) - **50 Hz**
  - TF ë³€í™˜ ë°œí–‰

**ê³„ì‚° ë¡œì§**:
```python
# ë§¤ ì£¼ê¸°ë§ˆë‹¤ ì†ë„ ì ë¶„
x += v_x * cos(Î¸) * dt
y += v_x * sin(Î¸) * dt
Î¸ += Ï‰_z * angular_scale * dt  # â­ angular_scale ì ìš©

# angular_scale = 1.8819 (í˜„ì¬)
# ê¶Œì¥ê°’ = 2.1164 (í…ŒìŠ¤íŠ¸ ê²°ê³¼)
```

**ë¬¸ì œì **:
1. **angular_scale ë¶€ì •í™•**: 1.8819 â†’ 2.1164 (12.5% ì˜¤ì°¨)
2. **íšŒì „ ì¤‘ ë°ì´í„° ì†ì‹¤**: ì‹¤ì œ íšŒì „ì˜ 68% ì •ë„ë§Œ ì¸¡ì •
3. **ì—”ì½”ë” ìƒ˜í”Œë§ ì§€ì—°**: I2C ë³‘ëª©

---

### 3ï¸âƒ£ **apply_calib** (IMU ë³´ì •)

**ì—­í• **: IMU ì›ì‹œ ë°ì´í„°ì˜ ë°”ì´ì–´ìŠ¤ ì œê±°

**êµ¬ë… (Subscribers)**:
- `/transbot/imu` (sensor_msgs/msg/Imu) - **100 Hz**
  - MPU6050 ì›ì‹œ ë°ì´í„°

**ë°œí–‰ (Publishers)**:
- `/imu/data_calibrated` (sensor_msgs/msg/Imu) - **98 Hz** â­
  - ìì´ë¡œ ë°”ì´ì–´ìŠ¤ ì œê±°
  - ê°€ì†ë„ê³„ ë°”ì´ì–´ìŠ¤ ì œê±°
  - ìŠ¤ì¼€ì¼ íŒ©í„° ë³´ì •

**ë³´ì • ë°ì´í„°** (`imu_calib.yaml`):
```yaml
gyro_bias: [x, y, z]      # ì •ì§€ ìƒíƒœ ë“œë¦¬í”„íŠ¸
accel_bias: [x, y, z]     # ì¤‘ë ¥ ë°©í–¥ ì˜¤ì°¨
scale_factors: [...]      # ì„¼ì„œ ê²Œì¸ ë³´ì •
```

**íš¨ê³¼**:
- ìì´ë¡œ ë“œë¦¬í”„íŠ¸ ê°ì†Œ
- ê°ì†ë„ ì •í™•ë„ í–¥ìƒ
- ì¥ê¸° ì•ˆì •ì„± ê°œì„ 

---

### 4ï¸âƒ£ **ekf_filter_node** (ì„¼ì„œ ìœµí•©)

**ì—­í• **: Odomê³¼ IMUë¥¼ ìœµí•©í•˜ì—¬ ìµœì  ì¶”ì •

**êµ¬ë… (Subscribers)**:
- `/odom_raw` (nav_msgs/msg/Odometry) - **50 Hz**
  - ìœ„ì¹˜ (x, y, yaw) - ì‹ ë¢°ë„ 80%
  - ì†ë„ (v_x, v_y, Ï‰_z) - ì‹ ë¢°ë„ ë‚®ìŒ
  
- `/imu/data_calibrated` (sensor_msgs/msg/Imu) - **98 Hz**
  - ê°ì†ë„ (Ï‰_z) - ì‹ ë¢°ë„ 69%
  - **ê°ë„ ì œê³µ ì•ˆ í•¨** (configì—ì„œ ë¹„í™œì„±í™”)

**ë°œí–‰ (Publishers)**:
- `/odometry/filtered` (nav_msgs/msg/Odometry) - **49 Hz** â­
  - EKF ìœµí•© ê²°ê³¼
  - ìœ„ì¹˜: Odom ìš°ì„  (80%)
  - ê°ì†ë„: IMU ìš°ì„  (69%)
  - ê°ë„: Odomë§Œ ì‚¬ìš© (IMUëŠ” ê°ë„ ì œê³µ ì•ˆ í•¨)
  
- `/tf` (map â†’ odom) - **49 Hz**
  - SLAMì´ë‚˜ AMCLì—ì„œ ì‚¬ìš©
  - í˜„ì¬: identity transform (ì‚¬ìš© ì•ˆ í•¨)

**Kalman Filter ê°€ì¤‘ì¹˜**:

| ìƒíƒœ ë³€ìˆ˜ | IMU ê°€ì¤‘ì¹˜ | Odom ê°€ì¤‘ì¹˜ | ìš°ì„  ì„¼ì„œ |
|-----------|-----------|------------|----------|
| ìœ„ì¹˜ (x, y) | N/A | 100% | Odom |
| ê°ë„ (yaw) | N/A | 80% | Odom â­ |
| ì†ë„ (v_x, v_y) | N/A | 100% | Odom |
| ê°ì†ë„ (Ï‰_z) | 69% | 0.05% | IMU â­ |

**ì„¤ì • íŒŒì¼**: `ekf_config.yaml`
```yaml
odom0_config: [true, true, false,    # x, y
               false, false, true,    # yaw â­
               true, true, false,
               false, false, true,    # vyaw
               false, false, false]

imu0_config: [false, false, false,   # ìœ„ì¹˜ ì‚¬ìš© ì•ˆ í•¨
              false, false, false,   # ê°ë„ ì‚¬ìš© ì•ˆ í•¨ â­
              false, false, false,
              false, false, true,    # vyawë§Œ ì‚¬ìš© â­
              false, false, false]
```

**ë¬¸ì œì **:
1. **IMU ê°ë„ ë¯¸ì‚¬ìš©**: IMUê°€ ê°ì†ë„ë§Œ ì œê³µí•˜ë„ë¡ ì„¤ì •
2. **Odom ê°ë„ ì‹ ë¢°**: ë¶€ì •í™•í•œ Odom ê°ë„ì— 80% ì˜ì¡´
3. **ê²°ê³¼**: EKF â‰ˆ Odom (IMU ê°ì†ë„ëŠ” ìŠ¤ë¬´ë”©ì—ë§Œ ì‚¬ìš©)

---

## âŒ ë°œê²¬ëœ ë¬¸ì œì 

### 1. **/odom í† í”½ ë°œí–‰ì ì—†ìŒ**

```
Publisher count: 0  âŒ
Subscription count: 1 (rviz2)
```

**ì›ì¸**:
- ê¸°ì¡´ ì‹œìŠ¤í…œì—ì„œëŠ” `base_node`ê°€ `/odom` ë°œí–‰
- í˜„ì¬ëŠ” `/odom_raw`ë§Œ ë°œí–‰
- RVizëŠ” `/odom` êµ¬ë…í•˜ì§€ë§Œ ë°ì´í„° ì—†ìŒ

**ì˜í–¥**:
- RVizì—ì„œ ì˜¤ë„ë©”íŠ¸ë¦¬ ì‹œê°í™” ë¶ˆê°€
- ë””ë²„ê¹… ì–´ë ¤ì›€

**í•´ê²°**:
```bash
# RViz ì„¤ì • ë³€ê²½: /odom â†’ /odometry/filtered
# ë˜ëŠ”
# base_nodeê°€ /odomë„ í•¨ê»˜ ë°œí–‰í•˜ë„ë¡ ìˆ˜ì •
```

---

### 2. **/odometry/filtered ë¯¸ì‚¬ìš©**

```
Publisher count: 1 (ekf_filter_node)
Subscription count: 0  âŒ
```

**ì›ì¸**:
- EKFê°€ ìœµí•© ê²°ê³¼ë¥¼ ë°œí–‰í•˜ì§€ë§Œ ì•„ë¬´ë„ êµ¬ë… ì•ˆ í•¨
- SLAM Toolboxë„ `/odom_raw` ì§ì ‘ êµ¬ë… (ì¶”ì •)

**ì˜í–¥**:
- EKF ì„¼ì„œ ìœµí•©ì˜ ì´ì  í™œìš© ëª» í•¨
- ë¶€ì •í™•í•œ `/odom_raw`ë¥¼ ì§ì ‘ ì‚¬ìš©
- CPU ìì› ë‚­ë¹„ (EKF ê³„ì‚°ë§Œ í•˜ê³  ë²„ë¦¼)

**í•´ê²°**:
```yaml
# slam_toolbox ì„¤ì • ë³€ê²½
odom_frame: odometry/filtered  # odom_raw â†’ odometry/filtered
```

---

### 3. **angular_scale ë¶€ì •í™•**

**í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
```
í˜„ì¬: 1.8819
ê¶Œì¥: 2.1164
ì˜¤ì°¨: 12.5%

ì‹¤ì œ íš¨ê³¼:
- Odomì´ 90Â° ì¸¡ì • â†’ ì‹¤ì œ 113Â° íšŒì „
- Odom ê¸°ì¤€ 90Â° íšŒì „ â†’ ì‹¤ì œ 135Â° íšŒì „
```

**ì›ì¸**:
1. ì—”ì½”ë” ë°ì´í„° ì†ì‹¤ (íšŒì „ ì¤‘ 32%)
2. íœ  ìŠ¬ë¦½ (ì œìë¦¬ íšŒì „ ì‹œ)
3. ê¸°ê³„ì  ë°±ë˜ì‹œ
4. ì´ˆê¸° ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì˜¤ë¥˜

**ì˜í–¥**:
- SLAM ë§µ ì™œê³¡
- ë‚´ë¹„ê²Œì´ì…˜ ê²½ë¡œ ì˜¤ì°¨
- EKFë„ ì˜ëª»ëœ Odom ë”°ë¼ê°

---

### 4. **EKFê°€ Odom ê°ë„ë¥¼ ë§¹ì‹ **

**ì„¤ì •**:
```yaml
imu0_config: [false, false, false]  # ê°ë„ ì‚¬ìš© ì•ˆ í•¨
odom0_pose_covariance[5]: 0.01     # yaw ì‹ ë¢°ë„ 80%
```

**ê²°ê³¼**:
- IMU ê°ì†ë„ ì ë¶„ì€ ì •í™• (87-90Â°)
- Odom ê°ë„ëŠ” ë¶€ì •í™• (70Â°)
- EKFëŠ” Odom ë”°ë¼ê° (70Â°)

**ì´ìœ **:
- IMUëŠ” ê°ì†ë„ë§Œ ì œê³µ â†’ EKFê°€ ì ë¶„
- IMU ì ë¶„ì€ ëˆ„ì  ì˜¤ì°¨ ìˆìŒ (drift)
- ì¥ê¸°ì ìœ¼ë¡œ Odom ê°ë„ë¥¼ ê¸°ì¤€ì ìœ¼ë¡œ ì‚¬ìš©

**í•´ê²° ë°©í–¥**:
1. Odom ê°ë„ ì •í™•ë„ ê°œì„  (angular_scale)
2. EKF ì„¤ì • ì¡°ì • (Odom ì‹ ë¢°ë„ ê°ì†Œ)
3. IMU ê°ë„ë„ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì • ë³€ê²½ (ê³ ê¸‰)

---

## ğŸ“ˆ ë°œí–‰ ì£¼íŒŒìˆ˜ ìš”ì•½

| í† í”½ | ì„¤ê³„ ì£¼íŒŒìˆ˜ | ì‹¤ì œ ì¸¡ì • | ìƒíƒœ |
|------|-----------|----------|------|
| `/transbot/get_vel` | 50 Hz | 49.9 Hz | âœ… ì •ìƒ |
| `/odom_raw` | 50 Hz | 50.4 Hz | âœ… ì •ìƒ |
| `/imu/data_calibrated` | 100 Hz | 98.0 Hz | âœ… ì •ìƒ |
| `/odometry/filtered` | 50 Hz | 49.0 Hz | âœ… ì •ìƒ |

**ê²°ë¡ **: ëª¨ë“  í† í”½ì´ ì„¤ê³„ëœ ì£¼íŒŒìˆ˜ë¡œ ë°œí–‰ ì¤‘ âœ…

**í•˜ì§€ë§Œ**:
- 50Hzë„ ê³ ì† íšŒì „ ì‹œ ë¶ˆì¶©ë¶„ (ë°ì´í„° ì†ì‹¤ 32%)
- I2C ë³‘ëª©ìœ¼ë¡œ ì¸í•œ ì§€ì—° ê°€ëŠ¥ì„±
- ìƒ˜í”Œë§ ì§€í„° (std dev ~5ms)

---

## ğŸ”§ ê¶Œì¥ ê°œì„  ì‚¬í•­

### ì¦‰ì‹œ ì ìš© (High Priority)

1. **angular_scale ìˆ˜ì •**
```python
# transbot_full_system.launch.py
'angular_scale': 2.1164,  # 1.8819 â†’ 2.1164
```

2. **RViz ì˜¤ë„ë©”íŠ¸ë¦¬ í† í”½ ë³€ê²½**
```
/odom â†’ /odometry/filtered
```

3. **SLAM Toolbox ì˜¤ë„ë©”íŠ¸ë¦¬ ì†ŒìŠ¤ ë³€ê²½**
```yaml
# slam_toolbox ì„¤ì •
odom_frame: odometry/filtered
```

### ì¤‘ê¸° ì ìš© (Medium Priority)

4. **base_nodeì—ì„œ /odomë„ ë°œí–‰**
```python
# í˜¸í™˜ì„±ì„ ìœ„í•´ /odomê³¼ /odom_raw ë™ì‹œ ë°œí–‰
```

5. **íšŒì „ ì†ë„ ì œí•œ**
```python
# ë°ì´í„° ì†ì‹¤ ìµœì†Œí™”
max_angular_velocity: 0.2  # 0.3 â†’ 0.2 rad/s
```

6. **EKF ì„¤ì • ìµœì í™”**
```yaml
# Odom yaw ì‹ ë¢°ë„ ê°ì†Œ
odom0_pose_covariance[5]: 0.04  # 0.01 â†’ 0.04
```

### ì¥ê¸° ì ìš© (Low Priority)

7. **ì—”ì½”ë” í´ë§ ì£¼íŒŒìˆ˜ ì¦ê°€**
```python
# 50Hz â†’ 100Hz (I2C ë³‘ëª© ì£¼ì˜)
```

8. **í•˜ë“œì›¨ì–´ ì—…ê·¸ë ˆì´ë“œ**
- ê³ í•´ìƒë„ ì—”ì½”ë” (390 PPR â†’ 1000 PPR)
- ê³ ì„±ëŠ¥ IMU (MPU6050 â†’ ICM-20948)

---

## ğŸ“ ë°ì´í„° íë¦„ ì´í•´

### ì •ìƒ ë™ì‘ ì‹œë‚˜ë¦¬ì˜¤

```
1. ì‚¬ìš©ìê°€ /cmd_vel ëª…ë ¹ ë°œí–‰
   â†“
2. transbot_driverê°€ ëª¨í„° ì œì–´
   â†“
3. ì—”ì½”ë”ê°€ ì‹¤ì œ ì†ë„ ì¸¡ì •
   â†“
4. transbot_driverê°€ /transbot/get_vel ë°œí–‰ (50Hz)
   â†“
5. base_nodeê°€ ì†ë„ ì ë¶„ â†’ /odom_raw ë°œí–‰ (50Hz)
   â†“
6. IMUê°€ ê°ì†ë„ ì¸¡ì • â†’ apply_calibê°€ ë³´ì • (98Hz)
   â†“
7. ekf_filter_nodeê°€ Odom + IMU ìœµí•©
   â†“
8. /odometry/filtered ë°œí–‰ (49Hz)
   â†“
9. âŒ ì•„ë¬´ë„ êµ¬ë… ì•ˆ í•¨ (ë¬¸ì œ!)
```

### ê°œì„  í›„ ì‹œë‚˜ë¦¬ì˜¤

```
1. ì‚¬ìš©ìê°€ /cmd_vel ëª…ë ¹ ë°œí–‰
   â†“
2. transbot_driverê°€ ëª¨í„° ì œì–´
   â†“
3. ì—”ì½”ë”ê°€ ì‹¤ì œ ì†ë„ ì¸¡ì •
   â†“
4. transbot_driverê°€ /transbot/get_vel ë°œí–‰ (50Hz)
   â†“
5. base_nodeê°€ ì†ë„ ì ë¶„ â†’ /odom_raw ë°œí–‰ (50Hz)
   - angular_scale 2.1164 ì ìš© âœ…
   â†“
6. IMUê°€ ê°ì†ë„ ì¸¡ì • â†’ apply_calibê°€ ë³´ì • (98Hz)
   â†“
7. ekf_filter_nodeê°€ Odom + IMU ìœµí•©
   â†“
8. /odometry/filtered ë°œí–‰ (49Hz) âœ…
   â†“
9. SLAM Toolboxê°€ /odometry/filtered êµ¬ë… âœ…
   â†“
10. ì •í™•í•œ ë§µ ìƒì„± ë° ë¡œì»¬ë¼ì´ì œì´ì…˜ âœ…
```

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì¦‰ì‹œ í™•ì¸ ì‚¬í•­

- [ ] `/odometry/filtered`ë¥¼ êµ¬ë…í•˜ëŠ” ë…¸ë“œ í™•ì¸
  ```bash
  ros2 topic info /odometry/filtered -v
  ```

- [ ] SLAM Toolbox ì˜¤ë„ë©”íŠ¸ë¦¬ ì†ŒìŠ¤ í™•ì¸
  ```bash
  ros2 param get /slam_toolbox odom_frame
  ```

- [ ] RViz ì˜¤ë„ë©”íŠ¸ë¦¬ í‘œì‹œ í™•ì¸
  - Odometry Display ì¶”ê°€
  - Topic: /odometry/filtered

- [ ] angular_scale ì ìš© í™•ì¸
  ```bash
  ros2 param get /base_node angular_scale
  ```

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

1. **angular_scale ë³€ê²½ í›„ íšŒì „ í…ŒìŠ¤íŠ¸**
```bash
python3 ekf_comparison_test.py
# ê¸°ëŒ€: IMU vs Odom ì˜¤ì°¨ < 5%
```

2. **EKF ìœµí•© ë™ì‘ í™•ì¸**
```bash
ros2 topic echo /odometry/filtered --field pose.pose.position
# vs
ros2 topic echo /odom_raw --field pose.pose.position
```

3. **SLAM ë§µ í’ˆì§ˆ í™•ì¸**
- ì‚¬ê°í˜• ê²½ë¡œ ì£¼í–‰
- ì‹œì‘ì  ë³µê·€ ì‹œ ì˜¤ì°¨ ì¸¡ì •
- ë§µ ì™œê³¡ ì •ë„ í™•ì¸

---

## ğŸ”— ê´€ë ¨ íŒŒì¼

### Launch Files
- `transbot_full_system.launch.py`: ì „ì²´ ì‹œìŠ¤í…œ ì‹¤í–‰
  - Line 154: `angular_scale` ì„¤ì •

### Config Files
- `ekf_config.yaml`: EKF ì„¼ì„œ ìœµí•© ì„¤ì •
  - Odom/IMU ê³µë¶„ì‚° ì„¤ì •
  - Process noise ì„¤ì •
  - ì„¼ì„œ ì‚¬ìš© ì—¬ë¶€ (config)

### Source Files
- `transbot_driver.py`: í•˜ë“œì›¨ì–´ ì¸í„°í˜ì´ìŠ¤
  - Line 132: ì†ë„ ë°œí–‰ ì£¼íŒŒìˆ˜ (50Hz)
  
- `base_node.cpp`: ì˜¤ë„ë©”íŠ¸ë¦¬ ê³„ì‚°
  - angular_scale ì ìš©
  - ì†ë„ ì ë¶„

### Test Scripts
- `ekf_comparison_test.py`: ì„¼ì„œ ì •í™•ë„ ê²€ì¦
- `ODOM_DRIFT_ROOT_CAUSE_ANALYSIS.md`: ë¬¸ì œ ë¶„ì„ ë¬¸ì„œ

---

## ğŸ“Š ìš”ì•½

### í˜„ì¬ ìƒíƒœ
- âœ… ëª¨ë“  ë…¸ë“œê°€ ì •ìƒ ë™ì‘
- âœ… ë°œí–‰ ì£¼íŒŒìˆ˜ ì •ìƒ (50Hz/98Hz)
- âŒ angular_scale ë¶€ì •í™• (12.5% ì˜¤ì°¨)
- âŒ /odometry/filtered ë¯¸ì‚¬ìš©
- âŒ /odom ë°œí–‰ì ì—†ìŒ
- âŒ EKFê°€ ë¶€ì •í™•í•œ Odom ë”°ë¼ê°

### í•µì‹¬ ë¬¸ì œ
1. **angular_scale 1.8819 â†’ 2.1164** (ê°€ì¥ ì¤‘ìš”)
2. **/odometry/filteredë¥¼ SLAMì—ì„œ ì‚¬ìš©** (ì¤‘ìš”)
3. **EKF ì„¤ì • ìµœì í™”** (ì„ íƒ)

### ê¸°ëŒ€ íš¨ê³¼
- íšŒì „ ì •í™•ë„ 12.5% í–¥ìƒ
- SLAM ë§µ ì™œê³¡ ê°ì†Œ
- ë‚´ë¹„ê²Œì´ì…˜ ì •í™•ë„ í–¥ìƒ
- ì„¼ì„œ ìœµí•© í™œìš©
